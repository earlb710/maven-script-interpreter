// TEST: screen.setProperty and screen.getProperty functions
print "=== Testing Screen Property Functions ===";

// Create a simple screen with a text field and button
screen propTest = {
    "title": "Property Test Screen",
    "width": 500,
    "height": 300,
    "vars": [
        {
            "name": "username",
            "type": "string",
            "default": "John Doe"
        },
        {
            "name": "age",
            "type": "int",
            "default": 25
        }
    ],
    "area": [
        {
            "name": "main",
            "type": "vbox",
            "items": [
                {
                    "name": "usernameField",
                    "sequence": 0,
                    "varRef": "username",
                    "display": {
                        "type": "textfield",
                        "labelText": "Username:"
                    }
                },
                {
                    "name": "ageField",
                    "sequence": 1,
                    "varRef": "age",
                    "display": {
                        "type": "textfield",
                        "labelText": "Age:"
                    }
                },
                {
                    "name": "toggleBtn",
                    "sequence": 2,
                    "display": {
                        "type": "button",
                        "labelText": "Toggle Username Field",
                        "onClick": "var editable: string = call screen.getProperty('propTest.usernameField', 'editable'); print 'Current editable: ' + editable; var newVal: bool = !editable; call screen.setProperty('propTest.usernameField', 'editable', newVal); print 'Set editable to: ' + newVal;"
                    }
                },
                {
                    "name": "colorBtn",
                    "sequence": 3,
                    "display": {
                        "type": "button",
                        "labelText": "Change Age Field Color",
                        "onClick": "call screen.setProperty('propTest.ageField', 'textColor', 'blue'); call screen.setProperty('propTest.ageField', 'backgroundColor', 'lightgray'); print 'Changed age field colors';"
                    }
                },
                {
                    "name": "hideBtn",
                    "sequence": 4,
                    "display": {
                        "type": "button",
                        "labelText": "Hide Username Field",
                        "onClick": "call screen.setProperty('propTest.usernameField', 'visible', false); print 'Username field hidden';"
                    }
                },
                {
                    "name": "showBtn",
                    "sequence": 5,
                    "display": {
                        "type": "button",
                        "labelText": "Show Username Field",
                        "onClick": "call screen.setProperty('propTest.usernameField', 'visible', true); print 'Username field shown';"
                    }
                }
            ]
        }
    ]
};

// Test getting properties before showing screen
print "Testing screen.getProperty before showing screen:";
var editable: string = call screen.getProperty("propTest.usernameField", "editable");
print "  usernameField editable: " + editable;

var visible: bool = call screen.getProperty("propTest.usernameField", "visible");
print "  usernameField visible: " + visible;

// Test setting properties before showing screen
print "\nTesting screen.setProperty before showing screen:";
call screen.setProperty("propTest.usernameField", "tooltip", "Enter your username here");
print "  Set tooltip on usernameField";

call screen.setProperty("propTest.ageField", "alignment", "right");
print "  Set alignment on ageField to right";

// Show the screen
print "\nShowing screen...";
screen propTest show;
print "Screen is now visible. Click the buttons to test property changes.";
