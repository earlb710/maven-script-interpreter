// Test script for TreeView expand and collapse events
// Description: Demonstrates onExpand and onCollapse event handlers for TreeView components
// Features: File tree structure with expand/collapse events that update status labels and track event counts

print "DEBUG: Starting TreeView events test...";

// Screen definition with TreeView
screen testTreeEvents = {
    "title": "TreeView Events Test",
    "width": 800,
    "height": 600,
    "area": [
        {
            "name": "mainArea",
            "type": "vbox",
            "spacing": "10",
            "padding": "15",
            "items": [
                {
                    "name": "eventInfo",
                    "seq": 1,
                    "display": {
                        "type": "label",
                        "labelText": "Expand or collapse tree nodes to see events",
                        "itemFontSize": "14px",
                        "itemBold": true
                    }
                },
                {
                    "name": "fileTree",
                    "seq": 2,
                    "display": {
                        "type": "treeview",
                        "displayRecords": 15,
                        "showRoot": true,
                        "treeItems": [
                            {
                                "value": "Root",
                                "expanded": true,
                                "children": [
                                    {
                                        "value": "src",
                                        "expanded": false,
                                        "children": [
                                            {"value": "main.ebs"},
                                            {"value": "utils.ebs"}
                                        ]
                                    },
                                    {
                                        "value": "docs",
                                        "expanded": false,
                                        "children": [
                                            {"value": "README.md"},
                                            {"value": "GUIDE.md"}
                                        ]
                                    },
                                    {
                                        "value": "tests",
                                        "expanded": false,
                                        "children": [
                                            {"value": "test1.ebs"},
                                            {"value": "test2.ebs"}
                                        ]
                                    }
                                ]
                            }
                        ],
                        "onExpand": "print 'Node EXPANDED: ' + fileTree.expandedItem; call scr.setProperty('testTreeEvents', 'eventInfo', 'labelText', 'EXPANDED: ' + fileTree.expandedItem);",
                        "onCollapse": "print 'Node COLLAPSED: ' + fileTree.collapsedItem; call scr.setProperty('testTreeEvents', 'eventInfo', 'labelText', 'COLLAPSED: ' + fileTree.collapsedItem);"
                    }
                },
                {
                    "name": "eventCount",
                    "seq": 3,
                    "display": {
                        "type": "label",
                        "labelText": "Event count: 0",
                        "itemFontSize": "12px"
                    }
                },
                {
                    "name": "refreshBtn",
                    "seq": 4,
                    "display": {
                        "type": "button",
                        "labelText": "Refresh Event Count",
                        "onClick": "int expandCount = call sys.getEventCount('testTreeEvents', 'fileTree', 'onExpand'); int collapseCount = call sys.getEventCount('testTreeEvents', 'fileTree', 'onCollapse'); int total = expandCount + collapseCount; string msg = 'Events: ' + total + ' (Expand: ' + expandCount + ', Collapse: ' + collapseCount + ')'; call scr.setProperty('testTreeEvents', 'eventCount', 'labelText', msg);"
                    }
                }
            ]
        }
    ]
};

print "DEBUG: Screen definition complete.";

// Show the screen
show screen testTreeEvents;

print "TreeView events test screen created";
print "Expand and collapse tree nodes to trigger events";
